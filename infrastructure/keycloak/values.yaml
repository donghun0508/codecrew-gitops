image:
  repository: quay.io/keycloak/keycloak
  tag: "26.4.5"
  pullPolicy: IfNotPresent

replicas: 1

# kc.sh가 "start"까지 실행되도록 보수적으로 옵션 포함
command:
  - "/opt/keycloak/bin/kc.sh"
  - "start"
  - "--http-enabled=true"
  - "--http-port=8080"
  - "--hostname-strict=false"
  - "--hostname-strict-https=false"

http:
  relativePath: "/"

# 이 차트 스키마: string(|)만 허용
extraEnvFrom: |
  - secretRef:
      name: keycloak-auth
  - configMapRef:
      name: keycloak-config

dbchecker:
  enabled: true

database:
  vendor: mysql
  hostname: mysql.mysql.svc.cluster.local
  port: 3306
  database: keycloak
  username: keycloak
  existingSecret: keycloak-auth
  existingSecretKey: DB_PASSWORD

service:
  type: NodePort
  httpPort: 80
  httpsPort: 443
  httpNodePort: 30880
  httpsNodePort: 30443

resources:
  requests:
    cpu: 100m
    memory: 512Mi
  limits:
    cpu: 2000m
    memory: 2Gi

health:
  enabled: true

metrics:
  enabled: true

# probes도 string(|)로 (관리포트 9000을 직접 찌르기)
startupProbe: |
  httpGet:
    path: /health/ready
    port: 9000
  initialDelaySeconds: 20
  periodSeconds: 5
  timeoutSeconds: 2
  failureThreshold: 60

readinessProbe: |
  httpGet:
    path: /health/ready
    port: 9000
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 2
  failureThreshold: 12

livenessProbe: |
  httpGet:
    path: /health/live
    port: 9000
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 2
  failureThreshold: 6
